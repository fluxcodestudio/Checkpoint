---
phase: 06-dashboard-monitoring
plan: 02
type: execute
---

<objective>
Create an all-projects dashboard view showing comprehensive backup status and health.

Purpose: Enable users to see status of ALL their projects from one place.
Output: Interactive TUI dashboard and CLI summary command.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior plan in this phase:
@.planning/phases/06-dashboard-monitoring/06-01-SUMMARY.md

# Existing infrastructure:
@lib/dashboard-ui.sh
@lib/dashboard-status.sh
@lib/global-status.sh
@lib/projects-registry.sh
@lib/retention-policy.sh
@bin/checkpoint.sh

**Tech stack available:** Pure bash, dialog/whiptail for TUI
**Established patterns:**
- TUI dialogs via lib/dashboard-ui.sh (show_menu, show_msgbox)
- Status collection via lib/dashboard-status.sh
- Global aggregation via lib/global-status.sh (from 06-01)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create all-projects dashboard command</name>
  <files>bin/backup-dashboard.sh</files>
  <action>
Create new CLI command for all-projects dashboard view:

backup-dashboard.sh - Show dashboard of all registered projects

Display format (table-like):
```
═══════════════════════════════════════════════════════════
  Checkpoint - All Projects Dashboard
═══════════════════════════════════════════════════════════

  Project               Status    Last Backup    Storage
  ─────────────────────────────────────────────────────────
  my-web-app            ✅ OK     2 min ago      1.2 GB
  api-server            ⚠ STALE   26 hours ago   845 MB
  mobile-app            ✅ OK     1 hour ago     234 MB
  ─────────────────────────────────────────────────────────
  Total: 3 projects, 2.3 GB                   1 needs backup

Actions:
  [1] Backup all projects now
  [2] Select project for details
  [3] Cleanup old backups (preview)
  [q] Quit
```

Features:
- List all registered projects from projects-registry.sh
- Show health status (OK/STALE/ERROR), last backup time, storage used
- Highlight projects needing attention (yellow/red)
- Retention tier summary when --verbose: "Keeping: 24 hourly, 7 daily, 4 weekly"
- Option to backup all: iterate and run backup-now.sh for each

Use plain text table formatting - no dialog required for basic view.
Add --interactive flag for dialog-based menu selection.
  </action>
  <verify>./bin/backup-dashboard.sh && ./bin/backup-dashboard.sh --interactive</verify>
  <done>Dashboard displays all projects with status, storage, and action options</done>
</task>

<task type="auto">
  <name>Task 2: Add detailed project view to dashboard</name>
  <files>bin/backup-dashboard.sh</files>
  <action>
Extend dashboard with detailed single-project view:

backup-dashboard.sh --project "my-web-app" - Show detailed view

Display:
```
═══════════════════════════════════════════════════════════
  Project: my-web-app
═══════════════════════════════════════════════════════════

  Status:        ✅ Healthy
  Last Backup:   2 minutes ago (2026-01-11 10:45:32)
  Next Backup:   ~58 minutes (activity trigger active)

  Storage Breakdown:
    Current files:     1.2 GB (mirror in files/)
    Archived versions: 845 MB (234 file versions)
    Database dumps:    156 MB (12 dumps)
    ─────────────────────────────────
    Total:             2.2 GB

  Retention Status (Time Machine style):
    Hourly (24h):   23 snapshots (keeping all)
    Daily (7d):     6 representatives
    Weekly (4w):    3 representatives
    Monthly (12m):  2 representatives

  Recent Activity:
    • 10:45:32 - Backup completed (triggered by file change)
    • 09:12:15 - Backup completed (triggered by git commit)
    • Yesterday - Database backup (PostgreSQL)

  Actions:
    [b] Backup now
    [r] Restore wizard
    [c] Configure
    [l] Cleanup preview
    [q] Back to dashboard
```

Get retention stats from lib/retention-policy.sh functions.
Parse backup.log for recent activity if available.
  </action>
  <verify>./bin/backup-dashboard.sh --project "$(basename "$PWD")"</verify>
  <done>Detailed project view shows comprehensive backup info including retention tiers</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `./bin/backup-dashboard.sh` displays all projects in table format
- [ ] `./bin/backup-dashboard.sh --interactive` shows dialog-based menu
- [ ] `./bin/backup-dashboard.sh --project NAME` shows detailed single-project view
- [ ] Retention tier stats display correctly
- [ ] Actions work (backup all, select project)
</verification>

<success_criteria>

- All-projects dashboard shows status table of every registered project
- Interactive mode allows project selection and actions
- Detailed project view includes storage breakdown and retention tier stats
- Pure bash implementation with no new dependencies
</success_criteria>

<output>
After completion, create `.planning/phases/06-dashboard-monitoring/06-02-SUMMARY.md`
</output>
