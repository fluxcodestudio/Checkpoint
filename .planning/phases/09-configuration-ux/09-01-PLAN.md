---
phase: 09-configuration-ux
plan: 01
type: execute
---

<objective>
Update configuration template with Phase 8 options and improved defaults.

Purpose: Ensure new projects get all configuration options with sensible defaults.
Output: Updated templates/backup-config.sh with alert, notification, and quiet hours settings.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-monitoring-enhancements/08-03-SUMMARY.md

**Key context:**
- Phase 8-03 added: ALERT_WARNING_HOURS, ALERT_ERROR_HOURS, NOTIFY_ON_SUCCESS, NOTIFY_ON_WARNING, NOTIFY_ON_ERROR, NOTIFY_ESCALATION_HOURS, NOTIFY_SOUND, PROJECT_NOTIFY_ENABLED, QUIET_HOURS, QUIET_HOURS_BLOCK_ERRORS
- Template at templates/backup-config.sh needs these options
- Defaults should reflect learned best practices from v1.0 and v1.1

**Source files:**
@templates/backup-config.sh
@lib/backup-lib.sh (for current default values)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add alert and notification settings to template</name>
  <files>templates/backup-config.sh</files>
  <action>
Add a new section "ALERTS AND NOTIFICATIONS" after the LOGGING section with:

```bash
# ==============================================================================
# ALERTS AND NOTIFICATIONS
# ==============================================================================

# Alert thresholds (when backup is considered stale)
# Warning state: backup older than this many hours
ALERT_WARNING_HOURS=24

# Error state: backup older than this many hours
ALERT_ERROR_HOURS=72

# Notification preferences
NOTIFY_ON_SUCCESS=false      # Notify after successful backup (useful after fixing issues)
NOTIFY_ON_WARNING=true       # Notify when backup becomes stale (warning threshold)
NOTIFY_ON_ERROR=true         # Notify on backup failures

# Escalation: hours between repeated notifications for same issue
NOTIFY_ESCALATION_HOURS=3

# Notification sound: default, Basso, Glass, Hero, Pop, none
NOTIFY_SOUND="default"

# Per-project notification override (set to false to silence this project)
PROJECT_NOTIFY_ENABLED=true

# ==============================================================================
# QUIET HOURS
# ==============================================================================

# Suppress non-critical notifications during quiet hours
# Format: START-END in 24-hour time (e.g., "22-07" for 10pm to 7am)
# Leave empty to disable quiet hours
QUIET_HOURS=""

# Block even critical errors during quiet hours (default: false = critical errors always notify)
QUIET_HOURS_BLOCK_ERRORS=false
```

Place this section logically after LOGGING and before STATE FILES.
  </action>
  <verify>grep -q "ALERT_WARNING_HOURS" templates/backup-config.sh && grep -q "QUIET_HOURS" templates/backup-config.sh</verify>
  <done>Template includes all Phase 8 alert/notification configuration options</done>
</task>

<task type="auto">
  <name>Task 2: Update defaults and add missing tiered retention options</name>
  <files>templates/backup-config.sh</files>
  <action>
1. Ensure RETENTION section includes tiered retention options (from Phase 5):
   ```bash
   # Tiered retention (Phase 5) - smart space management
   # Keeps: all backups <24h, hourly 1-7d, daily 7-30d, weekly 30-90d, monthly 90d+
   TIERED_RETENTION_ENABLED=true
   ```

2. Update file header comment to mention v1.1 features

3. Ensure CLOUD_FOLDER_ENABLED defaults to true (learned best practice - cloud sync should be on by default)

4. Add comment about config file versioning:
   ```bash
   # Configuration version (for migration detection)
   CONFIG_VERSION="1.1"
   ```

Add CONFIG_VERSION near the top of the file, after the header comment.
  </action>
  <verify>grep -q "CONFIG_VERSION" templates/backup-config.sh && grep -q "TIERED_RETENTION_ENABLED" templates/backup-config.sh</verify>
  <done>Template has CONFIG_VERSION, tiered retention option, and sensible v1.1 defaults</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] templates/backup-config.sh contains all Phase 8 options
- [ ] ALERT_WARNING_HOURS, ALERT_ERROR_HOURS, NOTIFY_* options present
- [ ] QUIET_HOURS and QUIET_HOURS_BLOCK_ERRORS present
- [ ] CONFIG_VERSION set to "1.1"
- [ ] File is valid bash (bash -n templates/backup-config.sh)
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Template includes all configuration options from Phase 5-8
- New projects will get complete configuration with sensible defaults
</success_criteria>

<output>
After completion, create `.planning/phases/09-configuration-ux/09-01-SUMMARY.md`
</output>
