<!-- MERGE_DELTA:TODO -->

## Phase 5: Cloud Backup Integration ðŸ“¦

**Goal:** Add cloud storage support via rclone
**Timeline:** Week 6 (Jan 29 - Feb 4)
**Priority:** ðŸŸ¡ HIGH

### 5.1 Local Path Selection - 0.5 days

- [ ] Enhance `bin/backup-config.sh` wizard
  - [ ] Add "Choose backup location" step
  - [ ] Option 1: Project folder (./backups)
  - [ ] Option 2: External drive (/Volumes/Backups)
  - [ ] Option 3: Custom path (with validation)
  - [ ] Validate path exists and is writable
  - [ ] Create directory if doesn't exist
  - [ ] Update LOCAL_BACKUP_DIR in config

### 5.2 rclone Integration - 1 day

- [ ] Create `lib/cloud-backup.sh`
  - [ ] Function: `check_rclone_installed()` - Detect rclone
  - [ ] Function: `install_rclone()` - Install if needed
  - [ ] Function: `setup_rclone_remote()` - Run config wizard
  - [ ] Function: `list_rclone_remotes()` - Show configured remotes
  - [ ] Function: `test_rclone_connection()` - Verify connectivity
  - [ ] Error handling for all functions

- [ ] Enhance `bin/backup-config.sh` wizard
  - [ ] Add "Cloud backup" section
  - [ ] Ask: Local only / Cloud only / Both
  - [ ] If cloud: Choose provider (Dropbox/GDrive/OneDrive/iCloud)
  - [ ] Check if rclone installed
  - [ ] Offer to install rclone if missing
  - [ ] Run rclone config if needed
  - [ ] Select remote from list
  - [ ] Choose cloud path
  - [ ] Ask what to upload (databases/critical/all)
  - [ ] Save cloud config variables

### 5.3 Cloud Upload Implementation - 1 day

- [ ] Enhance `lib/cloud-backup.sh`
  - [ ] Function: `cloud_upload_databases()` - Upload DB backups
  - [ ] Function: `cloud_upload_critical()` - Upload .env, credentials
  - [ ] Function: `cloud_upload_files()` - Upload all files
  - [ ] Function: `cloud_upload()` - Main upload function
  - [ ] Support background uploads (don't block)
  - [ ] Add progress indication
  - [ ] Add retry logic (3 attempts with backoff)
  - [ ] Log all cloud operations
  - [ ] Handle network errors gracefully

- [ ] Modify `bin/backup-daemon.sh`
  - [ ] Source lib/cloud-backup.sh
  - [ ] After local backup, check BACKUP_LOCATION
  - [ ] If "cloud" or "both", trigger cloud upload
  - [ ] Run cloud upload in background
  - [ ] Don't wait for completion
  - [ ] Log cloud upload PID
  - [ ] Add cloud status to backup status

- [ ] Modify `bin/backup-now.sh`
  - [ ] Add `--local-only` flag
  - [ ] Add `--cloud-only` flag
  - [ ] Add `--skip-cloud` flag
  - [ ] Trigger cloud upload after local backup
  - [ ] Show upload progress if foreground

### 5.4 Multi-Provider Support - 0.5 days

- [ ] Add provider-specific handling
  - [ ] Dropbox: Handle 2GB file limit
  - [ ] Google Drive: Optimize for large files
  - [ ] OneDrive: Handle path encoding
  - [ ] iCloud: Use native folder on macOS
  - [ ] Detect provider from remote type
  - [ ] Provider-specific error messages

- [ ] Add provider documentation
  - [ ] Setup guide for Dropbox
  - [ ] Setup guide for Google Drive
  - [ ] Setup guide for OneDrive
  - [ ] Setup guide for iCloud Drive
  - [ ] Cost comparison table
  - [ ] Free tier limits

### 5.5 Status & Monitoring - 0.5 days

- [ ] Enhance `bin/backup-status.sh`
  - [ ] Show cloud backup status
  - [ ] Last cloud upload time
  - [ ] Cloud upload errors
  - [ ] Cloud storage used
  - [ ] Cloud remote name
  - [ ] Next scheduled upload

- [ ] Add cloud health check
  - [ ] Test cloud connectivity
  - [ ] Verify remote exists
  - [ ] Check cloud space available
  - [ ] Warn if approaching limits

### 5.6 Configuration & Settings - 0.5 days

- [ ] Add config template `templates/backup-config.yaml`
  - [ ] Cloud backup section
  - [ ] All cloud options documented
  - [ ] Example configurations

- [ ] Config validation
  - [ ] Validate CLOUD_REMOTE_NAME exists
  - [ ] Validate CLOUD_BACKUP_PATH format
  - [ ] Warn if cloud enabled but rclone missing
  - [ ] Check remote accessibility

### 5.7 Error Handling & Recovery - 0.5 days

- [ ] Network failure handling
  - [ ] Detect offline state
  - [ ] Queue uploads for later
  - [ ] Retry when connection restored
  - [ ] Don't fail local backup if cloud fails

- [ ] Upload recovery
  - [ ] Resume interrupted uploads
  - [ ] Track upload state
  - [ ] Clean up partial uploads
  - [ ] Retry failed uploads

### 5.8 Testing - 1 day

- [ ] Create `tests/integration/test-cloud-backup.sh`
  - [ ] Test local path selection
  - [ ] Test rclone installation detection
  - [ ] Test cloud config wizard (mocked)
  - [ ] Test upload functions (mocked rclone)
  - [ ] Test error handling
  - [ ] Test retry logic
  - [ ] Test background uploads

- [ ] Manual testing with real providers
  - [ ] Test Dropbox upload/download
  - [ ] Test Google Drive upload/download
  - [ ] Test OneDrive upload/download
  - [ ] Test large file uploads
  - [ ] Test network interruption
  - [ ] Test bandwidth limiting

### 5.9 Documentation - 1 day

- [ ] Create `docs/CLOUD-BACKUP.md`
  - [ ] Overview and benefits
  - [ ] Setup instructions
  - [ ] Provider comparison
  - [ ] Cost analysis
  - [ ] Security best practices
  - [ ] Troubleshooting
  - [ ] FAQ

- [ ] Update existing docs
  - [ ] Update README.md with cloud features
  - [ ] Update COMMANDS.md with cloud flags
  - [ ] Update MIGRATION.md if needed
  - [ ] Update installation guide

- [ ] Create examples
  - [ ] Example: Dropbox setup
  - [ ] Example: Google Drive setup
  - [ ] Example: Local + cloud hybrid
  - [ ] Example: Cloud-only configuration

### 5.10 Security & Privacy - 0.5 days

- [ ] Add encryption support
  - [ ] Document rclone crypt remote
  - [ ] Guide for encrypted backups
  - [ ] Key management best practices

- [ ] Privacy documentation
  - [ ] What data is uploaded
  - [ ] Provider access considerations
  - [ ] GDPR considerations
  - [ ] How to delete cloud backups

### Phase 5 Completion

- [ ] Integration testing (cloud + local)
- [ ] Performance testing (upload speeds)
- [ ] Security audit
- [ ] Update CHANGELOG.md
- [ ] Tag v2.1.0-beta1

<!-- /MERGE_DELTA:TODO -->
