# ClaudeCode Project Backups - Tmux Integration Configuration
# Add this to your ~/.tmux.conf
# Version: 1.2.0

# ==============================================================================
# STATUS BAR INTEGRATION
# ==============================================================================

# Set the path to the backup tmux status script
# UPDATE THIS PATH to match your installation
set-option -g @backup-status-script "/Volumes/WORK DRIVE - 4TB/WEB DEV/CLAUDE CODE PROJECT BACKUP/integrations/tmux/backup-tmux-status.sh"

# Status bar format options:
#   emoji     - Just emoji (✅)
#   compact   - Emoji + time (✅ 2h)
#   verbose   - Full status (✅ All backups current (2 projects, 2h ago))
#   time      - Just time (2h)
#   icon-only - Just emoji, no space
set-option -g @backup-status-format "emoji"

# Refresh interval (seconds) - how often to update status
set-option -g status-interval 60

# ==============================================================================
# STATUS BAR DISPLAY
# ==============================================================================

# Option 1: Add to right side of status bar (default tmux position)
set-option -g status-right "#(#{@backup-status-script} #{@backup-status-format}) | %H:%M %d-%b-%y"

# Option 2: Add to left side of status bar
# set-option -g status-left "#(#{@backup-status-script} #{@backup-status-format}) [#S] "

# Option 3: Custom position (example)
# set-option -g status-right "#(#{@backup-status-script} #{@backup-status-format}) | #H | %H:%M"

# ==============================================================================
# KEY BINDINGS
# ==============================================================================

# Backup commands via prefix + b + {command}
# prefix is usually Ctrl-b

# prefix + b + s - Show backup status
bind-key -T prefix s run-shell "tmux display-popup -E -w 80% -h 80% '#{@backup-status-script}/../../../bin/backup-status.sh; read -n 1 -p \"Press any key to close...\"'"

# prefix + b + n - Trigger backup now
bind-key -T prefix n run-shell "tmux display-popup -E '#{@backup-status-script}/../../../bin/backup-now.sh --force; read -n 1 -p \"Press any key to close...\"'"

# prefix + b + c - Show backup config
bind-key -T prefix c run-shell "tmux display-popup -E -w 80% -h 80% '#{@backup-status-script}/../../../bin/backup-config.sh show; read -n 1 -p \"Press any key to close...\"'"

# prefix + b + l - Show cleanup preview
bind-key -T prefix l run-shell "tmux display-popup -E -w 80% -h 80% '#{@backup-status-script}/../../../bin/backup-cleanup.sh --preview; read -n 1 -p \"Press any key to close...\"'"

# prefix + b + r - List backups for restore
bind-key -T prefix r run-shell "tmux display-popup -E -w 80% -h 80% '#{@backup-status-script}/../../../bin/backup-restore.sh --list; read -n 1 -p \"Press any key to close...\"'"

# ==============================================================================
# ALTERNATIVE KEY BINDINGS (Uncomment if you prefer)
# ==============================================================================

# Use prefix + B (capital B) for backup submenu
# bind-key B switch-client -T backup-menu
# bind-key -T backup-menu s run-shell "tmux display-popup -E -w 80% -h 80% '#{@backup-status-script}/../../../bin/backup-status.sh'"
# bind-key -T backup-menu n run-shell "tmux display-popup -E '#{@backup-status-script}/../../../bin/backup-now.sh --force'"
# bind-key -T backup-menu c run-shell "tmux display-popup -E -w 80% -h 80% '#{@backup-status-script}/../../../bin/backup-config.sh show'"

# ==============================================================================
# STATUS BAR STYLING (OPTIONAL)
# ==============================================================================

# Customize status bar colors
# set-option -g status-bg colour235
# set-option -g status-fg colour136
# set-option -g status-left-length 50
# set-option -g status-right-length 100

# ==============================================================================
# AUTO-TRIGGER ON PANE CHANGE (ADVANCED)
# ==============================================================================

# Automatically trigger backup when switching panes in git repos
# Uncomment to enable:
# set-hook -g after-select-pane 'run-shell "cd #{pane_current_path} && git rev-parse --git-dir &>/dev/null && #{@backup-status-script}/../../../bin/backup-now.sh --quiet &"'
